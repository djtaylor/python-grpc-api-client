[![Build Status](https://api.travis-ci.org/djtaylor/python-grpc-api-client.png)](https://api.travis-ci.org/djtaylor/python-grpc-api-client)

# gRPC API Client
This module aims to provide a client that handles compiled protocol buffer code for a generic endpoint. This module reads a `*.pb2` file generated by the `protoc` CLI tool. For documentation on how to generate protocul buffer bindings for your gRPC API endpoint please see: https://developers.google.com/protocol-buffers/docs/pythontutorial.

Your generated protocul buffer bindings must be in your Python path and available as an import. As `protoc` generates two files, they also must be able to resolve imports for each other.

### Local Dex Service
To build and run a local Dex server for testing:
```
$ make build_dex
$ make run_dex
```
This will spin up a Docker container with basic configuration for gRPC testing listening on port 35557.

### Protocol Buffer Definitions
The gRPC method handlers are generated automatically from the protocol buffers definition file. To see a list of available gRPC methods and their respective fields, please refer to the `proto` directory for the version of Dex you are using.

### Example Usage
You can connect to a Dex gRPC server:

```python
from dex_grpc.client import Dex_gRPC_Client

grpc_host = '127.0.0.1'
grpc_port = '5557'
ca_cert = '/my/tls/ca.crt'
client_cert = '/my/tls/client.crt'
client_key = '/my/tls/client.key'

# Create a secure client with TLS
secure_client = Dex_gRPC_Client(grpc_host, grpc_port,
  ca_cert = ca_cert,
  client_cert = client_cert,
  client_key = client_key
)

# Create an insecure client
insecure_client = Dex_gRPC_Client(grpc_host, grpc_port)

# Iterate through available gRPC methods
for method_name, method_obj in secure_client.api.items():
  print('gRPC Method[{}]: {}'.format(method_name, str(method_obj)))

```

### Tests
Testing is done with `unittest` and `nose` for discovery.
```
$ make test
```
